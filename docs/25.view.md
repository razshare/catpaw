# View

You can render twig files and serve them to the client using _view()_.

## Usage

Create a twig file, for example under _src/api/view.twig_

```twig
hello world!
```



Now create your route handler and respond with `view()`

```php
<?php
use function CatPaw\Web\view;
return fn () => view();
```

That's all it takes, your endpoint will respond with the twig view.

## Properties

You can set specific properties on your twig view with `view::withProperty()`

```php
<?php
use function CatPaw\Web\view;
return fn () => view()
                ->withProperty('title', 'My Document')
                ->withProperty('name', 'world')
                ->withProperty('fileName', 'view.twig');
```

Or you can set all the properties with `view::withProperties()`

```php
<?php
use function CatPaw\Web\view;
return fn () => view()->properties([
    'title' => 'My Document',
    'name' => 'world',
    'fileName' => 'view.twig',
]);
```

Then you can access those properties in your twig view, like you normally would.

```twig
{# @var name title #}
{# @var name string #}
{# @var fileName string #}

<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{{title}}</title>
</head>
<body>
    hello {{name}}, this is {{fileName}} speaking!
</body>
</html>
```


## Loading a Component

You can load a component with `loadComponent()`


```php
<?php
use function CatPaw\Core\anyError;
use function CatPaw\Web\loadComponent;
use CatPaw\Web\Server;

function main() {
    return anyError(function() {
        loadComponent('test.twig', 'component-name')->try();
        return Server::get()->withApiLocation('src/api')->start();
    });
}
```

This will load the `test.twig` and allow you to reference it in your twig files by the name of `component-name`.

## Loading Directories of Components

You can load whole directories of twig components with `loadComponentsFromDirectory()`

```php
<?php
use function CatPaw\Core\anyError;
use function CatPaw\Web\loadComponentsFromDirectory;
use CatPaw\Web\Server;

function main() {
    return anyError(function() {
        loadComponentsFromDirectory('src/components')->try();
        return Server::get()->withApiLocation('src/api')->start();
    });
}
```

This will load all files in the `components` directory.
You will then be able to reference these files in your twig views by using they filename relative to the directory which you provided.

For example if you have a component located in `components/buttons/red-button.twig`, you can reference it by `buttons/red-button.twig`, like so

```twig
{% extends "buttons/red-button.twig" %}

{% block slot %}
    click me!
{% endblock %}

```

## Other notes

> [!NOTE]
> Twig files are cached internally and kept in memory for a performance boost.\
> The first time they're being rendered they will be loaded from disk.\
> Subsequent rendering requests will read the file directly from memory.\
> The only exception to this rule are components loaded through `loadComponent()` or `loadComponentsFromDirectory()`, which are cached immediately instead of on the first render.
