# Byte Range Requests

> **Note**\
> Byte range requests are supported out of the box in the default file server.\
> You need not configure anything to enable byte range requests for your web root directory (which is usually `server/www`).

Use `CatPaw\Web\Services\ByteRangeService` to serve byte range requests manually.

```php
use Amp\Http\Server\Request;
use Amp\Http\Server\Response;
use function CatPaw\anyError;
use function CatPaw\ok;
use CatPaw\Unsafe;
use function CatPaw\Web\failure;
use CatPaw\Web\Server;
use CatPaw\Web\Services\ByteRangeService;

function main(): Unsafe {
    return anyError(
        $server = Server::create(),
        $server->value->router->get(
            path: "/{fileName}",
            callback: function(
                string $fileName,
                Request $request,
                Response $response,
                ByteRangeService $byteRange,
            ) {
                $responseAttempt = $byteRange->file(
                    fileName  : $fileName,
                    rangeQuery: $request->getHeader("range") ?? '',
                );

                if ($responseAttempt->error) {
                    return failure($responseAttempt->error->getMessage());
                }

                return ok($responseAttempt->value);
            }
        ),
        $server->value->start()->await(),
    );
}
```

Your endpoint will now serve bye range requests.

> [!Note]
> The `ByteRangeService::file` method throws a `InvalidByteRangeQueryException` exception whenever the given range query is not valid.
