# Byte Range Requests

> **Note**\
> Byte range requests are supported out of the box in the default file server.\
> You need not configure anything to enable byte range requests for your web root directory (which is
> usually `server/www`).

Use `CatPaw\Web\Services\ByteRangeService` to serve byte range requests manually.

```php
use Amp\Http\Server\Request;
use Amp\Http\Server\Response;
use function CatPaw\Core\stop;
use function CatPaw\Core\ok;
use CatPaw\Core\Unsafe;
use function CatPaw\Web\failure;
use CatPaw\Web\Server;
use CatPaw\Web\Services\ByteRangeService;

function main(): Unsafe {
    $server = Server::create()->try($error) or stop($error);
    $server->router->get(
        path: "/{fileName}",
        function: function(
            string $fileName,
            Request $request,
            Response $response,
            ByteRangeService $byteRange,
        ) {
            $response = $byteRange->file(fileName:$fileName, rangeQuery:$request->getHeader("range") ?? '')->try($error);

            if ($error) {
                return failure($error->getMessage());
            }

            return ok($response);
        }
    )->try($error)                         or stop($error);
    $server->start()->await()->try($error) or stop($error);
}
```

Your endpoint will now serve bye range requests.

> [!Note]
> The `ByteRangeService::file` method throws a `InvalidByteRangeQueryException` exception whenever the given range query
> is not valid.
